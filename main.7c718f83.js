"use strict";(self.webpackChunktic_tac_toe=self.webpackChunktic_tac_toe||[]).push([[792],{467:(t,e,s)=>{s(917);const n=class{template;appRoot;buttons;controller;constructor(t,e){this.template='<div class="home-menu"> <h1 class="home-menu__title">Tic Tac Toe</h1> <nav class="home-menu__nav"> <button class="home-menu__button" id="playButton" data-js-home-button> <span class="home-menu__button-text">Play 1 vs 1</span> </button> <button class="home-menu__button" id="settingsButton" data-js-home-button> <span class="home-menu__button-text">Settings</span> </button> </nav> </div> ',this.appRoot=t,this.controller=e}render(){this.appRoot.innerHTML=this.template,this.bindEvents()}bindEvents(){this.buttons=this.appRoot.querySelectorAll("[data-js-home-button]"),this.buttons.forEach((t=>{t.addEventListener("click",this.handleButtonClick)}))}handleButtonClick=t=>{const e=t.currentTarget.id;this.controller.navigateTo(e)};cleanup(){this.buttons&&this.buttons.length>0&&this.buttons.forEach((t=>{t.removeEventListener("click",this.handleButtonClick)})),this.buttons=null,console.log("HomeView event listeners cleaned up.")}},a=class{view;constructor(t){this.view=new n(t,this)}show(){this.view.render()}navigateTo(t){switch(t){case"playButton":window.location.hash="game";break;case"settingsButton":window.location.hash="settings";break;default:return void console.warn(`Unknown button clicked: ${t}`)}}cleanup(){this.view&&this.view.cleanup()}},i=class{board;turn;status="active";winner={name:null,winnerCells:[]};player1="x";player2="o";observers=[];constructor(){this.resetBoard()}subscribe(t){this.observers.push(t)}notifyUpdate(){const t=this.getState();this.observers.forEach((e=>e(t)))}getState(){return{board:[...this.board],turn:this.turn,status:this.status,winner:this.winner}}resetBoard(){this.board=Array(9).fill(null),this.turn=this.player1,this.status="active",this.winner={name:null,winnerCells:[]},this.notifyUpdate()}setCell(t){if(null===this.board[t]){if(this.board[t]=this.turn,this.iskWin())return void this.notifyUpdate();this.changeTurn(),this.notifyUpdate()}}changeTurn(){this.turn=this.turn===this.player1?this.player2:this.player1}iskWin(){const t=[[0,1,2],[3,4,5],[6,7,8],[0,3,6],[1,4,7],[2,5,8],[0,4,8],[2,4,6]];for(const e of t){const[t,s,n]=e;if(this.board[t]&&this.board[t]===this.board[s]&&this.board[t]===this.board[n])return this.winner={name:this.turn,winnerCells:[t,s,n]},this.status="finished",!0}}},o=class{crossIcon='<svg class="cross-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">\n\t<line id="cross-line1" x1="20" y1="20" x2="80" y2="80" stroke="currentcolor" stroke-width="8"\n\t\tstroke-linecap="round" />\n\t<line id="cross-line2" x1="80" y1="20" x2="20" y2="80" stroke="currentcolor" stroke-width="8"\n\t\tstroke-linecap="round" />\n</svg>';circleIcon='<svg class="circle-svg" viewBox="0 0 100 100" xmlns="http://www.w3.org/2000/svg">\n\t<circle id="circle" cx="50" cy="50" r="40" fill="none" stroke="currentcolor" stroke-width="8" />\n</svg>';template='<div class="game"> <h1 class="game__title">Game field</h1> <div class="game__current-player"> Current Player: <span class="game__current-player-name">X</span> </div> <div class="game__win-line" data-js-game-win-line></div> <div class="game__board"> <div class="game__cell" data-js-game-cell="0"></div> <div class="game__cell" data-js-game-cell="1"></div> <div class="game__cell" data-js-game-cell="2"></div> <div class="game__cell" data-js-game-cell="3"></div> <div class="game__cell" data-js-game-cell="4"></div> <div class="game__cell" data-js-game-cell="5"></div> <div class="game__cell" data-js-game-cell="6"></div> <div class="game__cell" data-js-game-cell="7"></div> <div class="game__cell" data-js-game-cell="8"></div> <div class="game__board-line game__board-line--v1" data-js-board-line="1"></div> <div class="game__board-line game__board-line--v2" data-js-board-line="2"></div> <div class="game__board-line game__board-line--h1" data-js-board-line="3"></div> <div class="game__board-line game__board-line--h2" data-js-board-line="4"></div> </div> <button class="game__restart-button" id="restartButton" data-js-game-button> Restart </button> <button class="game__back-button" id="backButton" data-js-game-button> Back </button> <dialog class="game__dialog dialog" data-js-game-dialog> <div class="dialog__content"> <p class="dialog__game-winner"> Player <span class="dialog__player-name" data-js-dialog-winner>temporary text</span> has won! </p> <button class="dialog__close-button" id="dialogCloseButton" data-js-game-button> Close </button> </div> </dialog> <svg> <defs> <filter id="pencil-sketch-filter"> <feturbulence type="fractalNoise" baseFrequency="0.03" numOctaves="3" result="noise"/> <fedisplacementmap in="SourceGraphic" in2="noise" scale="5" xChannelSelector="R" yChannelSelector="G"/> <fegaussianblur stdDeviation="0.5"/> <fecolormatrix type="matrix" values="1 0 0 0 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t 0 1 0 0 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t 0 0 1 0 0\n\t\t\t\t\t\t\t\t\t\t\t\t\t 0 0 0 5 -2"/> </filter> </defs> </svg> </div> ';appRoot;controller;buttons;cells=[];currentPlayerElem;winBoardLine;winnerElem;winnerDialogElem;status="undefined";constructor(t,e){this.appRoot=t,this.controller=e}render(t){console.log("state of view: ",t),"undefined"===this.status&&(this.appRoot.innerHTML=this.template,this.findElements(),this.setListeners(),this.setBoardLines()),this.setViewState(t)}findElements(){this.currentPlayerElem=this.appRoot.querySelector(".game__current-player-name"),this.cells=this.appRoot.querySelectorAll("[data-js-game-cell]"),this.buttons=this.appRoot.querySelectorAll("[data-js-game-button]"),this.winBoardLine=this.appRoot.querySelector("[data-js-game-win-line]"),this.winnerDialogElem=this.appRoot.querySelector("[data-js-game-dialog]"),this.winnerElem=this.winnerDialogElem.querySelector("[data-js-dialog-winner]")}setListeners(){this.buttons.forEach((t=>{t.addEventListener("click",this.handleButtonClick)})),this.cells.forEach((t=>{t.addEventListener("click",this.handleCellClick)}))}setBoardLines(){const t=this.appRoot.querySelector(".game__board");for(let e=1;e<=4;e++)t.style.setProperty(`--random-angle-${e}`,`${Math.floor(11*Math.random())+-5}deg`)}handleButtonClick=t=>{const e=t.currentTarget.id;this.controller.buttonAction(e)};handleCellClick=t=>{if("finished"===this.status)return;const e=Number(t.currentTarget.dataset.jsGameCell);this.controller.makeMove(e)};setViewState(t){this.status=t.status,this.cells.forEach(((e,s)=>{e.innerHTML||("x"===t.board[s]?(e.innerHTML=this.crossIcon,this.setRandomCellMargin(e)):"o"===t.board[s]&&(e.innerHTML=this.circleIcon,this.setRandomCellMargin(e)))})),this.currentPlayerElem.textContent=t.turn,t.winner.name&&(this.winnerElem.textContent=`Winner: ${t.winner.name}`,this.status="finished",this.drawWinLine(t.winner.winnerCells,t.winner.name))}drawWinLine(t,e){const s=this.cells[t[0]].getBoundingClientRect(),n=this.cells[t[2]].getBoundingClientRect();console.log("startCellData: ",s),console.log("endCellData: ",n);const a={x1:s.x,y1:s.y+s.height/2,x2:n.x+n.width,y2:n.y+n.height/2};console.log("horizontalLineXY: ",a);const i={x1:s.x+s.width/2,y1:s.y,x2:n.x+n.width/2,y2:n.y+n.height},o={x1:s.x,y1:s.y,x2:n.x+n.width,y2:n.y+n.height},l={x1:s.x,y1:s.y+s.height,x2:n.x+n.width,y2:n.y},r={horizontal:s.y===n.y,vertical:s.x===n.x,diagonal1:n.x-s.x>0&&n.y-s.y>0,diagonal2:n.x-s.x<0&&n.y-s.y>0},c=Object.keys(r).find((t=>!0===r[t]));switch(c){case"horizontal":this.setWinLine(a,e);break;case"vertical":this.setWinLine(i,e);break;case"diagonal1":this.setWinLine(o,e);break;case"diagonal2":this.setWinLine(l,e);break;default:console.error("Unknown win type:",c)}}setWinLine(t,e){const s=t.x2-t.x1,n=t.y2-t.y1,a=Math.atan2(n,s)*(180/Math.PI),i=Math.sqrt(s*s+n*n),o="x"===e?"red":"blue";console.log("lineCoordinates: ",t),console.log("deltaX: ",s),console.log("deltaY: ",n),console.log("angle: ",a),console.log("lineLength: ",i),this.winBoardLine.style.setProperty("--left-indent",t.x1+"px"),this.winBoardLine.style.setProperty("--top-indent",t.y1+"px"),this.winBoardLine.style.setProperty("--line-length",i+"px"),this.winBoardLine.style.setProperty("--angle",a+"deg"),this.winBoardLine.style.setProperty("--color",o),this.winBoardLine.classList.add("game__win-line--active")}setRandomCellMargin(t){t.querySelector("svg").style.transform=`translate(${30*Math.random()-15}px, ${30*Math.random()-15}px)`}cleanup(){this.buttons&&this.buttons.length>0&&this.buttons.forEach((t=>{t.removeEventListener("click",this.handleButtonClick)})),this.buttons=null,this.cells=[],this.currentPlayerElem=null,this.winnerElem=null,this.status="undefined",console.log("GameView event listeners cleaned up.")}},l=class{model;view;constructor(t){this.model=new i,this.view=new o(t,this),this.model.subscribe(this.handleModelUpdate)}show(){this.view.render(this.model.getState())}handleModelUpdate=t=>{this.view.render(t)};buttonAction(t){switch(t){case"restartButton":this.view.cleanup(),this.model.resetBoard();break;case"backButton":window.location.hash="home",this.model.resetBoard();break;case"dialogCloseButton":this.view.hideDialog();break;default:return void console.warn(`Unknown button clicked: ${t}`)}}makeMove(t){this.model.setCell(t)}cleanup(){this.view&&this.view.cleanup()}},r=class{appRoot;homeController;gameController;settingsController;currentController;constructor(){if(this.appRoot=document.getElementById("app-root"),!this.appRoot)throw new Error("AppController Error: Root element #app-root not found.");this.homeController=new a(this.appRoot),this.gameController=new l(this.appRoot),window.addEventListener("hashchange",this.handleHashChange.bind(this)),this.handleHashChange()}handleHashChange(){const t=window.location.hash.slice(1);let e;switch(this.currentController&&"function"==typeof this.currentController.cleanup&&this.currentController.cleanup(),t){case"game":e=this.gameController;break;case"settings":e=this.settingsController;break;default:e=this.homeController}e&&e.show?(e.show(),this.currentController=e):(console.warn(`AppController Error: No controller found for hash: ${t}. Defaulting to home view.`),this.homeController.show(),this.currentController=this.homeController)}};document.addEventListener("DOMContentLoaded",(()=>{new r}))}},t=>{t.O(0,[869],(()=>t(t.s=467))),t.O()}]);